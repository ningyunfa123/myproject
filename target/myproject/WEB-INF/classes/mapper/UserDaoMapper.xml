<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.baidu.mybaidu.dao.UserDao">
    <select id="queryAllUser" resultType="java.util.Map">
		SELECT
			*
		FROM
			equ_user
		ORDER BY id DESC
		LIMIT 5
	</select>
    <select id="login" parameterType="com.baidu.mybaidu.pojo.User" resultType="com.baidu.mybaidu.pojo.User">
		SELECT
			* FROM equ_user e
		WHERE
			 e.userName = #{userName} AND e.password = #{password} limit 1

	</select>
    <select id="queryState" resultType="java.util.Map">
		SELECT
			COUNT(*) AS value,state AS name
		FROM
			equ_equipment
		GROUP BY state
	</select>
    <select id="queryRepairChart" resultType="java.util.Map">
        SELECT
        count(*) AS value,
        <if test="time == 1">
            date_format(createTime,'%Y-%m-%d') AS createTime
        </if>
        <if test="time == 2">
            date_format(createTime,'%Y-%m-%d') AS createTime
        </if>
        <if test="time == 3">
            date_format(createTime,'%Y-%m') AS createTime
        </if>

        FROM
        equ_repair
        WHERE
        <if test="time == 1">
            YEARWEEK(date_format(createTime,'%Y-%m-%d')) = YEARWEEK(now())
        </if>
        <if test="time == 2">
            date_format(createTime,'%Y-%m')=date_format(now(),'%Y-%m')
        </if>
        <if test="time == 3">
            date_format(createTime,'%Y')=date_format(now(),'%Y')
        </if>

        GROUP BY
        <if test="time == 1">
            date_format(createTime,'%Y-%m-%d')
        </if>
        <if test="time == 2">
            date_format(createTime,'%Y-%m-%d')
        </if>
        <if test="time == 3">
            date_format(createTime,'%Y-%m')
        </if>


    </select>
    <update id="updateUser" parameterType="com.baidu.mybaidu.pojo.User">
        UPDATE
            equ_user
        SET
          userName = #{userName},password = #{password}
        WHERE id=1
    </update>
</mapper>